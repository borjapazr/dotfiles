#!/usr/bin/env bash

source "$DOTFILES_PATH/scripts/core/_main.sh"
source "$DOTFILES_PATH/scripts/self/utils/install.sh"
source "$DOTFILES_PATH/scripts/self/utils/update.sh"

##? Install the dotfiles
##?
##? Usage:
##?    install
docs::parse "$@"

update_system

install_requirements

log::info "ğŸ”— Aplying symlinks"
"$DOTFILES_PATH/bin/dot" symlinks apply | log::file "ğŸ”— Aplying symlinks" || true

if ! str::contains zsh "$SHELL"; then
  log::info "ğŸ’» Setting ZSH as the default shell"
  sudo chsh -s "$(command -v zsh)" "${USER}" | log::file "ğŸ’» Setting ZSH as default shell"
fi

log::info "ğŸ“¥ Importing packages"
"$DOTFILES_PATH/bin/dot" package import 2>&1 | log::file "ğŸ“¥ Importing packages"
